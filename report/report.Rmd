---
title: "Report"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Introduction

TODO

### Problem Statement

TODO

### Research Questions

TODO

### Research Objectives

TODO

### Dataset

TODO

### Metadata

| Variable | Description |
| --- | --- |
| TODO | TODO |

### References

TODO


### Imports

```{r}
library(dplyr)
library(ggplot2)
library(caret)
```

```{r}
df <- read.csv("../data/student-por.csv", sep = ";", stringsAsFactors = TRUE)
head(df)
```

### Preprocessing

```{r}
str(df)
```

```{r}
summary(df)
```

Convert ordinal variables into ordered factors.

```{r}
df$famsize <- factor(df$famsize, ordered = TRUE, levels = c("LE3", "GT3"))
df$Medu <- factor(df$Medu, ordered = TRUE, levels = 0:4)
df$Fedu <- factor(df$Fedu, ordered = TRUE, levels = 0:4)
df$traveltime <- factor(df$traveltime, ordered = TRUE, levels = 1:4)
df$studytime <- factor(df$studytime, ordered = TRUE, levels = 1:4)
df$failures <- factor(df$failures, ordered = TRUE, levels = 0:4)
df$famrel <- factor(df$famrel, ordered = TRUE, levels = 1:5)
df$freetime <- factor(df$freetime, ordered = TRUE, levels = 1:5)
df$goout <- factor(df$goout, ordered = TRUE, levels = 1:5)
df$Dalc <- factor(df$Dalc, ordered = TRUE, levels = 1:5)
df$Walc <- factor(df$Walc, ordered = TRUE, levels = 1:5)
df$health <- factor(df$health, ordered = TRUE, levels = 1:5)
```

Create label from `G3`.

```{r}
df$result <- ifelse(df$G3 >= 10, "pass", "fail")
df$result <- as.factor(df$result)
```

### Descriptive Analysis

```{r}
str(df)
```

```{r}
summary(df)
```

### Exploratory Data Analysis

#### Univariate

```{r}
ggplot(df, aes(x = school)) + 
  geom_bar(fill='blue') +
  labs(x = "School",
       y = "No. of students",
       title = "1. Student's school")

ggplot(df, aes(x = sex)) + 
  geom_bar(fill='blue') +
  labs(x = "Sex",
       y = "No. of students",
       title = "2. Student's sex")

ggplot(df, aes(x = age)) + 
  geom_bar(fill='green', 
                 color = "black") +
  labs(x = "Age",
       y = "Frequency",
       title = "3. Student's age")

ggplot(df, aes(x = address)) + 
  geom_bar(fill='purple') +
  labs(x = "Address",
       y = "Frequency",
       title = "4. Student's home address type")

ggplot(df, aes(x = famsize)) + 
  geom_bar(fill='purple') +
  labs(x = "Family size",
       y = "Frequency",
       title = "5. Family size ")

ggplot(df, aes(x = Pstatus)) + 
  geom_bar(fill='purple') +
  labs(x = "Parent's Status",
       y = "Frequency",
       title = "6. Parent's cohabitation status ")

ggplot(df, aes(x = Medu)) + 
  geom_bar(fill='white', 
                 color = "black") +
  labs(x = "Medu",
       y = "Frequency",
       title = "7. Mother's education level")

ggplot(df, aes(x = Fedu)) + 
  geom_bar(fill='white', 
                 color = "black") +
  labs(x = "Fedu",
       y = "Frequency",
       title = "8. Father's education level")

ggplot(df, aes(x = Mjob)) + 
  geom_bar(fill='purple') +
  labs(x = "Mjob",
       y = "Frequency",
       title = "9. Mother's job")

ggplot(df, aes(x = Fjob)) + 
  geom_bar(fill='purple') +
  labs(x = "Fjob",
       y = "Frequency",
       title = "10. Father's job")

ggplot(df, aes(x = reason)) + 
  geom_bar(fill='purple') +
  labs(x = "Reason",
       y = "Frequency",
       title = "11. Reason for selecting school")

ggplot(df, aes(x = guardian)) + 
  geom_bar(fill='purple') +
  labs(x = "Guardian",
       y = "Frequency",
       title = "12. Student's guardian")

ggplot(df, aes(x = traveltime)) + 
  geom_bar(fill='white', 
                 color = "black") +
  labs(x = "Traveltime",
       y = "Frequency",
       title = "13. Home to school travel time")

ggplot(df, aes(x = studytime)) + 
  geom_bar(fill='white', 
                 color = "black") +
  labs(x = "Studytime",
       y = "Frequency",
       title = "14. Weekly study time")

ggplot(df, aes(x = failures)) +
  geom_bar(fill = "green", 
                 color = "black") + 
  labs(title="15. Number of past class failures")

ggplot(df, aes(x = schoolsup)) + 
  geom_bar(fill='blue') +
  labs(x = "Schoolsup",
       y = "Frequency",
       title = "16. Extra educational support")

ggplot(df, aes(x = famsup)) + 
  geom_bar(fill='blue') +
  labs(x = "Famsup",
       y = "Frequency",
       title = "17. Family educational support")

ggplot(df, aes(x = paid)) + 
  geom_bar(fill='blue') +
  labs(x = "Paid",
       y = "Frequency",
       title = "18. Extra paid Portuguese classes ")

ggplot(df, aes(x = activities)) + 
  geom_bar(fill='blue') +
  labs(x = "Activities",
       y = "Frequency",
       title = "19. Extra-curricular activities")

ggplot(df, aes(x = nursery)) + 
  geom_bar(fill='blue') +
  labs(x = "Nursery",
       y = "Frequency",
       title = "20. Attended nursery school")

ggplot(df, aes(x = higher)) + 
  geom_bar(fill='blue') +
  labs(x = "Higher",
       y = "Frequency",
       title = "21. Wants to take higher education")

ggplot(df, aes(x = internet)) + 
  geom_bar(fill='blue') +
  labs(x = "Internet",
       y = "Frequency",
       title = "22. Internet access at home")

ggplot(df, aes(x = romantic)) + 
  geom_bar(fill='blue') +
  labs(x = "Romantic",
       y = "Frequency",
       title = "23. In a romantic relationship")

ggplot(df, aes(x = famrel)) + 
  geom_bar(fill='white', 
                 color = "black") +
  labs(x = "Famrel",
       y = "Frequency",
       title = "24. Quality of family relationship")

ggplot(df, aes(x = freetime)) + 
  geom_bar(fill='white', 
                 color = "black") +
  labs(x = "Freetime",
       y = "Frequency",
       title = "25. Free time after school")

ggplot(df, aes(x = goout)) + 
  geom_bar(fill='white', 
                 color = "black") +
  labs(x = "Goout",
       y = "Frequency",
       title = "26. Going out with friends")

ggplot(df, aes(x = Dalc)) + 
  geom_bar(fill='white', 
                 color = "black") +
  labs(x = "Dalc",
       y = "Frequency",
       title = "27. Workday alcohol consumption")

ggplot(df, aes(x = Walc)) + 
  geom_bar(fill='white', 
                 color = "black") +
  labs(x = "Walc",
       y = "Frequency",
       title = "28. Weekend alcohol consumption")

ggplot(df, aes(x = health)) + 
  geom_bar(fill='white', 
                 color = "black") +
  labs(x = "health",
       y = "Frequency",
       title = "29. Current health status")

ggplot(df, aes(x = absences)) + 
  geom_bar(fill='green', 
                 color = "black")+
  labs(x = "Absences",
       y = "Frequency",
       title = "30. Number of school absences")

ggplot(df, aes(x = G1)) + 
  geom_bar(fill='pink', 
                 color = "black") +
  labs(x = "G1",
       y = "Frequency",
       title = "31. First period grade")

ggplot(df, aes(x = G2)) + 
  geom_bar(fill='pink', 
                 color = "black") +
  labs(x = "G2",
       y = "Frequency",
       title = "32. Second period grade")

ggplot(df, aes(x = G3)) + 
  geom_bar(fill='orange', 
                 color = "black") +
  labs(x = "G3",
       y = "Frequency",
       title = "33. Final grade-output target")

ggplot(df, aes(x = result)) + 
  geom_bar(fill='blue', 
                 color = "black") +
  labs(x = "Result",
       y = "Frequency",
       title = "34. Final grade-result")
```

#### Bivariate
General Function for Graph Plotting
```{r}
# bar graph for bivariate analysis
Unstacked_bi_bar_graph <- function(`x.axis` = "", Result = ""){
  # Result represents dependent variable / usually being drawn in y-axis 
  # x-axis represent independent variable 
  # dodge is used to un-stake the bar graph
  
  # 1. counts (or sums of weights)
  bar <- ggplot(df, aes(`x.axis`))
  
  # 2. Number of tuples in each class
  graph_output <- bar + geom_bar(aes(fill = `Result`), position = 'dodge') + 
    labs(y = 'Frequency') 
  
  # 3. get data from the graph 
  graph_label <- layer_data(graph_output)
  
  # 4. Annotate value at respective bar
  graph_output <- graph_output + annotate(geom = "text", label = graph_label$count, 
                                          x = graph_label$x, y = 15)
  
  return(graph_output)
}
```


```{r}
bar.bivar = Unstacked_bi_bar_graph(df$school, df$result)
bar.bivar = bar.bivar + ggtitle(label = '1. School vs Final Grade Result') +
  labs(x = "Student's School") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$sex, df$result)
bar.bivar = bar.bivar + ggtitle(label = '2. Gender vs Final Grade Result') +
  labs(x = "Student's Sex") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$age, df$result)
bar.bivar = bar.bivar + ggtitle(label = '3. Age vs Final Grade Result') +
  labs(x = "Student's Age") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$address, df$result)
bar.bivar = bar.bivar + ggtitle(label = "4. Student's Home Address Type vs Final Grade Result") +
  labs(x = "Address Type") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$famsize, df$result)
bar.bivar = bar.bivar + ggtitle(label = "5. Student's Family Size vs Final Grade Result") +
  labs(x = "Family Size") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$Pstatus, df$result)
bar.bivar = bar.bivar + ggtitle(label = "6. Parent's Cohabitation Status vs Final Grade Result") +
  labs(x = "Parent's Cohabitation Status") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$Medu, df$result)
bar.bivar = bar.bivar + ggtitle(label = "7. Mother's Education vs Final Grade Result") +
  labs(x = "Mother's Education Level") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$Fedu, df$result)
bar.bivar = bar.bivar + ggtitle(label = "8. Father's Education vs Final Grade Result") +
  labs(x = "Father's Education Level") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$Mjob, df$result)
bar.bivar = bar.bivar + ggtitle(label = "9. Mother's Job vs Final Grade Result") +
  labs(x = "Mother's Job") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$Fjob, df$result)
bar.bivar = bar.bivar + ggtitle(label = "10. Father's Job vs Final Grade Result") +
  labs(x = "Father's Job") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$reason, df$result)
bar.bivar = bar.bivar + ggtitle(label = "11. Reason to Choose Selected School vs Final Grade Result") + labs(x = "Reason Types") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$guardian, df$result)
bar.bivar = bar.bivar + ggtitle(label = "12. Student's Guardian vs Final Grade Result") +
  labs(x = "Guardian") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$traveltime, df$result)
bar.bivar = bar.bivar + ggtitle(label = "13. Home to School Travel Time vs Final Grade Result") +
  labs(x = "Travel Time") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$studytime, df$result)
bar.bivar = bar.bivar + ggtitle(label = "14. Weekly Study Time vs Final Grade Result") +
  labs(x = "Weekly Study Time") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$failures, df$result)
bar.bivar = bar.bivar + ggtitle(label = "15. Number of Past Class Failures vs Final Grade Result") +
  labs(x = "Number of Past Class Failures") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$schoolsup, df$result)
bar.bivar = bar.bivar + ggtitle(label = "16. Extra Educational Support vs Final Grade Result") +
  labs(x = "Extra Educational Support") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$famsup, df$result)
bar.bivar = bar.bivar + ggtitle(label = "17. Family Educational Support vs Final Grade Result") +
  labs(x = "Family Educational Support") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$paid, df$result)
bar.bivar = bar.bivar + 
  ggtitle(label = "18. Extra Paid Classes for Portuguese Subject vs Final Grade Result") + 
  labs(x = "Joined Extra Paid Classes?") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$activities, df$result)
bar.bivar = bar.bivar + ggtitle(label = "19. Extra-Curricular Activities vs Final Grade Result") +
  labs(x = "Joined Extra-Curricular Activities?") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$activities, df$result)
bar.bivar = bar.bivar + ggtitle(label = "20. Extra-Curricular Activities vs Final Grade Result") +
  labs(x = "Joined Extra-Curricular Activities?") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$internet, df$result)
bar.bivar = bar.bivar + ggtitle(label = "21. Internet Access at Home vs Final Grade Result") +
  labs(x = "Internet Access at Home") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$romantic, df$result)
bar.bivar = bar.bivar + ggtitle(label = "22. With a Romantic Relationship vs Final Grade Result") +
  labs(x = "With a Romantic Relationship?") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$famrel, df$result)
bar.bivar = bar.bivar + ggtitle(label = "23. Quality of Family Relationships vs Final Grade Result") + labs(x = "Quality of Family Relationships") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$freetime, df$result)
bar.bivar = bar.bivar + ggtitle(label = "24. Free Time After School vs Final Grade Result") +
  labs(x = "Free Time After School") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$goout, df$result)
bar.bivar = bar.bivar + ggtitle(label = "25. Going Out with Friends vs Final Grade Result") +
  labs(x = "Going Out with Friends") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$Dalc, df$result)
bar.bivar = bar.bivar + ggtitle(label = "26. Workday Alcohol Consumption vs Final Grade Result") +
  labs(x = "Workday Alcohol Consumption") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$Walc, df$result)
bar.bivar = bar.bivar + ggtitle(label = "27. Weekend Alcohol Consumption vs Final Grade Result") +
  labs(x = "Weekend Alcohol Consumption") 
bar.bivar

bar.bivar = Unstacked_bi_bar_graph(df$health, df$result)
bar.bivar = bar.bivar + ggtitle(label = "28. Current Health Status vs Final Grade Result") +
  labs(x = "Current Health Status") 
bar.bivar

ggplot(df, aes(y = absences, x = result)) +
  geom_boxplot() + 
  ggtitle(label = "29. Number of School Absences vs Final Grade Result") + 
  labs(y = "Number of School Absences", x = "Result") + 
  scale_y_continuous(breaks=seq(0,36,by=2))

ggplot(df, aes(y = G1, x = result)) +
  geom_boxplot() + 
  labs(title = "30. First Period Grade vs Final Grade Result",
       y = "First Period Grade", 
       x = 'Result') + 
  scale_y_continuous(breaks=seq(0,20,by=2))

ggplot(df, aes(y = G2, x = result)) +
  geom_boxplot() + 
  labs(title = "31. Second Period Grade vs Final Grade Result",
       y = "Second Period Grade", 
       x = 'Result') +
  scale_y_continuous(breaks=seq(0,20,by=2))

```

### Correlation Analysis

```{r}
# TODO
```

### Train-Test Split

Create train set and test set for regression and classification respectively.

#### Regression

```{r}
df_reg <- df

df_reg$result <- NULL

set.seed(42)

train_index_reg <- createDataPartition(
  df_reg$G3,
  p = 0.8,
  list = FALSE,
  times = 1
)

train_set_reg <- df_reg[train_index_reg, ]
test_set_reg <- df_reg[-train_index_reg, ]
```

#### Classification

```{r}
df_clf <- df

df_clf$G3 <- NULL

set.seed(42)

train_index_clf <- createDataPartition(
  df_clf$result,
  p = 0.8,
  list = FALSE,
  times = 1
)

train_set_clf <- df_clf[train_index_clf, ]
test_set_clf <- df_clf[-train_index_clf, ]
```

### Subsampling

Since we are dealing with imbalanced classes, we explore subsampling techniques for classification.

#### Original Sample

```{r}
table(train_set_clf$result)
```

#### Down-Sampling

```{r}
set.seed(42)

train_set_clf_down <- downSample(
  x = train_set_clf[, -ncol(train_set_clf)],
  y = train_set_clf$result,
  yname = "result"
)

table(train_set_clf_down$result)
```

#### Up-Sampling

```{r}
set.seed(42)

train_set_clf_up <- upSample(
  x = train_set_clf[, -ncol(train_set_clf)],
  y = train_set_clf$result,
  yname = "result"
)

table(train_set_clf_up$result)
```

### Modeling

Define repeated 10-fold cross validation.

```{r}
fit_control <- trainControl(
  method = "repeatedcv",
  number = 10,
  repeats = 10
)
```

#### Regression

Helper function for regression models

```{r}
train_evaluate_reg <- function(method = "", data = train_set_reg, tuneGrid = NULL, tuneLength = NULL, name="") {
  set.seed(42)
  
  fit <- train(
    G3 ~ .,
    data = data,
    method = method,
    trControl = fit_control,
    preProcess = c("center", "scale"),
    tuneGrid = tuneGrid,
    tuneLength = tuneLength
  )
  print(fit)

  pred <- predict(fit, test_set_reg)
  result <- postResample(pred = pred, obs = test_set_reg$G3)
  
  metrics = data.frame(
        Model = name,
        RMSE = result[["RMSE"]],
        Rsquared = result[["Rsquared"]],
        MAE = result[["MAE"]]
      )

  return(
    list(
      model = fit,
      metrics = metrics
    )
  )
}
```

```{r}
get_best_result = function(caret_fit) {
  best = which(rownames(caret_fit$results) == rownames(caret_fit$bestTune))
  best_result = caret_fit$results[best, ]
  rownames(best_result) = NULL
  best_result
}
```

1. Decision Tree

CART

- method = 'rpart'
- Type: Regression, Classification
- Tuning parameters:
  - cp (Complexity Parameter)
- Required packages: rpart
- A model-specific variable importance metric is available.

Training model with auto tuning:
```{r}
dt_reg <- train_evaluate_reg("rpart", name = "DT", tuneLength = 10)

```
Best parameters from tuning:
```{r}
get_best_result(dt_reg$model)
``` 

Plot the trained model:
```{r}
plot(dt_reg$model)
```
Value 0.005577788 is the optimal value for complexity parameter.

Evaluation of model:
```{r}
dt_reg$metrics
```

2. Random Forest

Random Forest

- method = 'ranger'
- Type: Classification, Regression
- Tuning parameters:
  - mtry (#Randomly Selected Predictors) (Number of variables randomly sampled as candidates at each split.)
  - splitrule (Splitting Rule)
  - min.node.size (Minimal Node Size)
- Required packages: e1071, ranger, dplyr
- A model-specific variable importance metric is available.

Training model with auto tuning:
```{r}
rf_reg <- train_evaluate_reg("ranger", name = "RF", tuneLength = 10)

```

Best parameters from tuning:
```{r}
get_best_result(rf_reg$model)
``` 

Plot the trained model:
```{r}
plot(rf_reg$model)
```

- For splitrule (splitting rule) = variance, mtry = 48 is already the optimal value.
- For splitrule (splitting rule) = extratrees, mtry = 64. Can try to tune with mtry between 64 and 72 (max mtry = 72).
- Tuning parameter 'min.node.size' was held constant at a value of 5, can try to tune with other values.

Evaluation of model:
```{r}
rf_reg$metrics
``` 
Training model with manual tuning:
- splitrule = variance or extratrees
- mtry between 48 to 72
- min.node.size between 1 to 10
```{r}
tuneGrid_rf_reg <- expand.grid(
  splitrule = c("variance","extratrees"),
  mtry = seq(48,72,by=2),
  min.node.size = seq(1,10)
)

rf_reg_manual_tune <- train_evaluate_reg("ranger", name = "RF", tuneGrid = tuneGrid_rf_reg)
```
Best parameters from tuning:
```{r}
get_best_result(rf_reg_manual_tune$model)
``` 

Plot the trained model:
```{r}
plot(rf_reg_manual_tune$model)
```

Optimal value for each parameters:
- mtry = 72
- splitrule = extratrees
- min.node.size = 9

Evaluation of model:
```{r}
rf_reg_manual_tune$metrics
``` 

3. SVM with Polynomial Kernel

Support Vector Machines with Polynomial Kernel

- method = 'svmPoly'
- Type: Regression, Classification
- Tuning parameters:
  - degree (Polynomial Degree)
  - scale (Scale)
  - C (Cost)
- Required packages: kernlab

Training model with auto tuning:
- We have tried with tuneLength of 10, unfortunately it took too much of time to finish, thus we have decided to go with tuneLength of 5 in SVM.
```{r}
svm_reg <- train_evaluate_reg("svmPoly", name = "SVM", tuneLength = 5)

```

Best parameters from tuning:
```{r}
get_best_result(svm_reg$model)
``` 

Plot the trained model:
```{r}
plot(svm_reg$model)
```
The parameters degree (Polynomial Degree) = 1, scale = 10, and C (Cost) = 0.25 reached their optimal value.

Evaluation of model:
```{r}
svm_reg$metrics
``` 

4. Elastic Net

Elasticnet

- method = 'enet'
- Type: Regression
- Tuning parameters:
  - fraction (Fraction of Full Solution)
  - lambda (Weight Decay)
- Required packages: elasticnet

Training model with auto tuning:
```{r}
en_reg <- train_evaluate_reg("enet", name = "Elastic Net", tuneLength = 10)

```

Best parameters from tuning:
```{r}
get_best_result(en_reg$model)
``` 

Plot the trained model:
```{r}
plot(en_reg$model)
```
The parameters Fraction (Fraction of Full Solution) = 0.4722222 and lambda (Weight Decay) = 0.01778279 reached their optimal value.

Evaluation of model:
```{r}
en_reg$metrics
```

5. Linear Regression

- method = ‘glmnet’
- Type: Regression, Classification
- Tuning parameters:
  - alpha (Mixing Percentage)
  - lambda (Regularization Parameter)
- Required packages: glmnet, Matrix
- A model-specific variable importance metric is available.

Training model with auto tuning:
```{r}
lr_reg <- train_evaluate_reg("glmnet", name = "Linear Regression", tuneLength = 10)

```

Best parameters from tuning:
```{r}
get_best_result(lr_reg$model)
``` 

Plot the trained model:
```{r}
plot(lr_reg$model)
```
The parameter alpha (Mixing Percentage) = 1 is the optimal value while there's possibility to get better result with lambda (Regularization Parameter) < 0.2110029.

Evaluation of model:
```{r}
lr_reg$metrics
```

Training model with manual tuning:
- alpha = 1
- lambda between 0.001 to 0.300
```{r}
tuneGrid_lr_reg <- expand.grid(
  alpha = c(1),
  lambda = seq(0.00,0.30,by=0.05)
)

lr_reg_manual_tune <- train_evaluate_reg("glmnet", name = "Linear Regression", tuneGrid = tuneGrid_lr_reg)
```
Best parameters from tuning:
```{r}
get_best_result(lr_reg_manual_tune$model)
``` 

Plot the trained model:
```{r}
plot(lr_reg_manual_tune$model)
```
The parameter alpha (Mixing Percentage) = 1 and lambda (Regularization Parameter) = 0.15 reached their optimal value.

Evaluation of model:
```{r}
lr_reg_manual_tune$metrics
```

#### Classification

```{r}
# TODO
```

### Evaluation

#### Regression

```{r}
df_eval_reg <- rbind(
  dt_reg$metrics, 
  rf_reg_manual_tune$metrics, 
  svm_reg$metrics,
  en_reg$metrics,
  lr_reg_manual_tune$metrics
)

df_eval_reg <- df_eval_reg[order(df_eval_reg$RMSE),]
row.names(df_eval_reg) <- NULL
df_eval_reg

```

```{r}
df_eval_reg["RMSE"] = round(df_eval_reg["RMSE"],4)
df_eval_reg %>%
  ggplot(aes(x = reorder(Model, RMSE), y = RMSE, fill = Model)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = RMSE), vjust=-0.5) +
  ggtitle("RMSE by Model") +
  xlab("Model") +
  ylim(0,1.5) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

```

#### Classification

```{r}
# TODO
```

### Conclusion

TODO
